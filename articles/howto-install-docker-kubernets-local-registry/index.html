<html>
  <head>
    <title>How-to setup docker, kubernetes and a local registry on
    your laptop</title>
    <link rel="stylesheet" type="text/css"
          href="/static/style/style.css">
    <link rel="stylesheet" type="text/css"
          href="/static/style/prism.css">
  </head>

  <body>
    <h2>Use Docker, Kubernetes And A Private Local Registry
    on your laptop</h1>
    <h3>Posted by: <a href="http://sethlakowske.com">Seth Lakowske</a></h3>
    <h4>Published: <time pubdate="pubdate">2016-06-04</time></h4>

    <H2>Summary</H2>

    This guide will walk you through the steps to setting up an
    environment to run Kubernets (k8s) on your laptop or workstation.
    You'll need to install Docker if you haven't already and
    Kubernetes client (kubectl).

    <H2>Requirements</H2>
    <ul>
      <li>
        <b>Docker:</b>
        Install <a href="https://www.docker.com/products/docker-toolbox">Docker Toolbox</a>.
      </li>
      <li>
        <b>Kubernetes:</b>
        Follow the instructions at <a href="http://kubernetes.io/docs/getting-started-guides/docker/">Running
          Kubernetes Locally via Docker</a>.
      </li>
    </ul>

    <H2>Run Kubernetes using Docker</H2>

    Once you have Docker Toolbox installed, you can leverage Docker to
    run Kubernetes.  Setup Kubernetes
    environment variables, then simply issue a docker run to install
    and run Kubernetes.

    <pre><code class="language-bash">export K8S_VERSION=$(curl -sS https://storage.googleapis.com/kubernetes-release/release/stable.txt)</code></pre>
    Now run the Hyperkube image.  This image will run a
    number of additional Kubernetes images used to orchestrate
    your cluster.
    <pre><code class="language-bash">export ARCH=amd64
        docker run -d \
        --volume=/:/rootfs:ro \
        --volume=/sys:/sys:rw \
        --volume=/var/lib/docker/:/var/lib/docker:rw \
        --volume=/var/lib/kubelet/:/var/lib/kubelet:rw \
        --volume=/var/run:/var/run:rw \
        --net=host \
        --pid=host \
        --privileged \
        gcr.io/google_containers/hyperkube-${ARCH}:${K8S_VERSION} \
        /hyperkube kubelet \
        --containerized \
        --hostname-override=127.0.0.1 \
        --api-servers=http://localhost:8080 \
        --config=/etc/kubernetes/manifests \
        --cluster-dns=10.0.0.10 \
        --cluster-domain=cluster.local \
            --allow-privileged --v=2</code></pre>
    Verify your setup is running.  You should see a number of
        containers in the list.
    <pre><code class="language-bash">docker ps</code></pre>
    Start a private local registry that Docker always restarts if the container dies.
    <pre><code class="language-bash">docker run -d -p 5000:5000 --restart=always --name registry registry:2</code></pre>
    Build an image and tag it.
    <pre><code class="language-bash">docker build -t hello-node .
docker tag hello-node localhost:5000/hello-node</code></pre>
    Push the image to our local registry.
    <pre><code class="language-bash">docker push localhost:5000/hello-node</code></pre>
    Now run a deployment in Kubernetes using the image and local registry.
    <pre><code class="language-bash">kubectl run hello-node --image=localhost:5000/hello-node --port=8888</code></pre>
        
    <script src="/static/bundles/triangles/bundle.js"></script>
    <table id="related"></table>
    
  </body>
