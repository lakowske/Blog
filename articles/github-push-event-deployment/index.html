<html>
<head>
  <title>Github push event deployment</title>
</head>
<body>
  <h1>Github push event deployment</h1>
  <h3>Posted by: Seth Lakowske</h3>
  <p>Published: <time pubdate="pubdate">2014-12-30</time></p>

  <p>github-webhook-deployer listens for github push events.
    It's a sidecar-service that runs along side your
    service.  When a push event is received, github-webhook-deployer
    pulls the code and kills the current process.  A daemon manager, 
    such as forever, restarts the service with the new codebase 
    and you have deployed using a Github push event.
  </p>


  <h2>Requirements</h2>

  <p>First, install nodejs if you haven't already.  Then create a directory
    to contain your project code.  Inside the new directory, run</p>

  <pre><code>
      #Initialize your project
      npm init
  </code></pre>

  <p>Next, add dependencies to your project.  We'll be using github-webhook-deployer
    and websocket-express.  </p>
      
  <pre><code>
      npm install git://github.com/lakowske/github-webhook-deployer --save
      npm install git://github.com/lakowske/websocket-express --save
  </code></pre>

<h2>Logic</h2>
  <p>Now, the blog code (<a href="https://raw.githubusercontent.com/lakowske/Blog/1b9de0e758a503c953c7b1a9db5c106f5395f3fb/index.js">index.js</a>)</p>

# Embed without a footer
<script src="http://gist-it.appspot.com/github/lakowske/Blog/blob/master/index.js?footer=0"></script>

  <pre><code>
      
      var WsStaticServer = require('websocket-express').WsStaticServer;
      var Deployer       = require('github-webhook-deployer');

      //the port we want to serve from
      var appPort = 3333

      //the path(s) we want to serve
      var path = __dirname + '/articles';

      //let the world know
      console.log(path);

      //Create a github deployer
      var deployer = new Deployer({path:'/webhook', secret : 'testSecret'});
      deployer.listen(appPort+1);

      //Create a static server with websockets
      var server = new WsStaticServer({
        path   : path,
        wsPath : '/webSocket'
      })
      server.listen(appPort);

  </pre></code>

</body>
</html>
